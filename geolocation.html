<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HTML5 Geolocation API - Get User Location with JavaScript</title>
<meta name="description" content="Learn the Geolocation API to get user location. Includes permission handling, accuracy options, and modern best practices for 2025.">
<meta name="keywords" content="geolocation API, HTML5 geolocation, JavaScript location, get user location, GPS JavaScript, permissions API">
<meta name="author" content="Web Development Education">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://yourdomain.com/geolocation.html">

<!-- Open Graph Meta Tags -->
<meta property="og:title" content="HTML5 Geolocation API - Get User Location with JavaScript">
<meta property="og:description" content="Learn the Geolocation API to get user location. Includes permission handling, accuracy options, and modern best practices for 2025.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://yourdomain.com/geolocation.html">
<meta property="og:image" content="https://yourdomain.com/i/unicorn-og.png">

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="HTML5 Geolocation API - Get User Location with JavaScript">
<meta name="twitter:description" content="Learn the Geolocation API to get user location. Includes permission handling, accuracy options, and modern best practices for 2025.">
<meta name="twitter:image" content="https://yourdomain.com/i/unicorn-og.png">

<link rel="stylesheet" href="unicorn-style.css">
</head>
<body>

<p>ü¶Ñ You are here: <a href="index.html">Unicorn Home</a> <span class="u">‚ú®</span> <a href="index.html">Dive Into Unicorn Magic</a> <span class="u">‚ú®</span></p>

<h1>Where the Unicorns Are (And So Are You)</h1>

<p class="a">üåü ‚ú® üåà</p>

<p class="f"><span style="font-size:4em;float:left;line-height:0.8;margin:0.1em 0.2em 0 0;background:linear-gradient(45deg,#ffd700,#ff69b4,#87ceeb,#9b59b6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold;">G</span>eolocation is like having a magical compass that always knows where you are in the unicorn realm. The browser can tell you your latitude and longitude, which you can then use to find the nearest magical meadow, rainbow, or herd of friendly unicorns!</p>

<h2>üó∫Ô∏è The Geolocation API (Modern 2025)</h2>

<p>Using geolocation is wonderfully simple:</p>

<pre><code>// Modern async/await approach
async function getLocation() {
  if (!navigator.geolocation) {
    alert("Your browser doesn't have a magical compass!");
    return;
  }
  
  try {
    const position = await new Promise((resolve, reject) =&gt; {
      navigator.geolocation.getCurrentPosition(resolve, reject);
    });
    
    const { latitude, longitude, accuracy } = position.coords;
    console.log(`üìç You are at: ${latitude}, ${longitude}`);
    console.log(`üìè Accuracy: ${accuracy} meters`);
    
  } catch (error) {
    handleLocationError(error);
  }
}

function handleLocationError(error) {
  switch(error.code) {
    case error.PERMISSION_DENIED:
      alert("Please allow location access! üôè");
      break;
    case error.POSITION_UNAVAILABLE:
      alert("Location unavailable - are you in a magic-free zone?");
      break;
    case error.TIMEOUT:
      alert("Location request timed out!");
      break;
  }
}</code></pre>

<p>üí° <strong>2025 Best Practice:</strong> Check permissions first with the Permissions API before requesting location!</p>

<pre><code>// Check permission status first
const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });

if (permissionStatus.state === 'granted') {
  // Already have permission!
  getLocation();
} else if (permissionStatus.state === 'prompt') {
  // Will ask user
  getLocation();
} else {
  // Permission denied
  console.log('Location access denied');
}

// Listen for permission changes
permissionStatus.addEventListener('change', () =&gt; {
  console.log('Permission changed to:', permissionStatus.state);
});</code></pre>

<h2>üîí Privacy & Permission</h2>

<p>Browsers will always ask the user's permission before sharing their location (like asking a unicorn's permission before petting). This is good! We respect privacy in the magical realms.</p>

<h2>üìç What You Get (Complete Data)</h2>

<p>The position object contains comprehensive location data:</p>

<pre><code>// All available coordinates
const coords = position.coords;

console.log('Latitude:', coords.latitude);        // Required ‚úÖ
console.log('Longitude:', coords.longitude);      // Required ‚úÖ
console.log('Accuracy (m):', coords.accuracy);    // Required ‚úÖ
console.log('Altitude (m):', coords.altitude);    // May be null
console.log('Altitude Accuracy:', coords.altitudeAccuracy); // May be null
console.log('Heading (degrees):', coords.heading); // May be null (0-360)
console.log('Speed (m/s):', coords.speed);        // May be null

// Timestamp
console.log('Timestamp:', position.timestamp);
console.log('Date:', new Date(position.timestamp));</code></pre>

<ul style="list-style:disc;padding-left:2em;">
<li style="margin:0.5em 0;"><code>latitude</code> ‚Äî How far north/south (-90 to 90)</li>
<li style="margin:0.5em 0;"><code>longitude</code> ‚Äî How far east/west (-180 to 180)</li>
<li style="margin:0.5em 0;"><code>accuracy</code> ‚Äî How accurate the reading is in meters</li>
<li style="margin:0.5em 0;"><code>altitude</code> ‚Äî Height above sea level (if available, GPS only)</li>
<li style="margin:0.5em 0;"><code>heading</code> ‚Äî Direction you're moving (0-360 degrees, if moving)</li>
<li style="margin:0.5em 0;"><code>speed</code> ‚Äî How fast you're moving in m/s (if available)</li>
</ul>

<p>üîí <strong>Privacy Note:</strong> Browsers always ask permission. HTTPS required (except localhost)!</p>

<h2>üéØ Watching Position (with Options)</h2>

<p>If you want to track movement (like following a unicorn's journey), use <code>watchPosition</code>:</p>

<pre><code>// Options for better control
const options = {
  enableHighAccuracy: true,  // Use GPS if available (drains battery!)
  timeout: 10000,            // Max wait time (10 seconds)
  maximumAge: 30000          // Accept cached position up to 30s old
};

let watchId = navigator.geolocation.watchPosition(
  (position) =&gt; {
    console.log('Position updated!', position.coords);
    updateMap(position.coords.latitude, position.coords.longitude);
  },
  (error) =&gt; {
    console.error('Location error:', error);
  },
  options
);

// Stop watching when done (important for battery!)
function stopTracking() {
  navigator.geolocation.clearWatch(watchId);
  console.log('Stopped tracking location');
}

// 2025 Best Practice: Clean up when page unloads
window.addEventListener('beforeunload', () =&gt; {
  if (watchId) {
    navigator.geolocation.clearWatch(watchId);
  }
});</code></pre>

<p>‚ö° <strong>Battery tip:</strong> <code>enableHighAccuracy: false</code> uses WiFi/cell towers (less accurate but much better for battery!)</p>

<h2>üõ†Ô∏è Practical Modern Example</h2>

<pre><code>// Complete modern geolocation implementation
class LocationService {
  static async getCurrentLocation() {
    // Check if geolocation is supported
    if (!('geolocation' in navigator)) {
      throw new Error('Geolocation not supported');
    }
    
    // Check permission first
    const permission = await navigator.permissions.query({ name: 'geolocation' });
    if (permission.state === 'denied') {
      throw new Error('Location permission denied');
    }
    
    // Get location with timeout
    return new Promise((resolve, reject) =&gt; {
      const options = {
        enableHighAccuracy: false, // Save battery
        timeout: 5000,
        maximumAge: 60000 // Accept 1-minute old position
      };
      
      navigator.geolocation.getCurrentPosition(
        resolve,
        reject,
        options
      );
    });
  }
  
  static async findNearby() {
    try {
      const position = await this.getCurrentLocation();
      const { latitude, longitude } = position.coords;
      
      // Use reverse geocoding API to get address
      const response = await fetch(
        `https://nominatim.openstreetmap.org/reverse?` +
        `lat=${latitude}&lon=${longitude}&format=json`
      );
      const data = await response.json();
      
      console.log('You are near:', data.display_name);
      return data;
      
    } catch (error) {
      console.error('Location error:', error);
      throw error;
    }
  }
}

// Usage
try {
  const position = await LocationService.getCurrentLocation();
  console.log('üìç Location:', position.coords);
  
  const nearby = await LocationService.findNearby();
  console.log('üè† Address:', nearby.display_name);
} catch (error) {
  console.error('Failed to get location:', error.message);
}</code></pre>

<h2>üó∫Ô∏è 2025: Integrating with Maps</h2>

<p>Modern mapping libraries make displaying location easy:</p>

<pre><code>// Using Leaflet (free, open-source)
const position = await LocationService.getCurrentLocation();
const { latitude, longitude } = position.coords;

// Initialize map
const map = L.map('map').setView([latitude, longitude], 13);

// Add OpenStreetMap tiles (free!)
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '¬© OpenStreetMap contributors'
}).addTo(map);

// Add marker at your location
L.marker([latitude, longitude])
  .addTo(map)
  .bindPopup('You are here! ü¶Ñ')
  .openPopup();

// Or use Google Maps, Mapbox, etc. (require API keys)</code></pre>

<p><strong>Popular mapping libraries (2025):</strong></p>
<ul style="list-style:disc;padding-left:2em;">
<li style="margin:0.5em 0;"><strong>Leaflet</strong> ‚Äî Free, lightweight, open-source ‚úÖ</li>
<li style="margin:0.5em 0;"><strong>Mapbox GL JS</strong> ‚Äî Beautiful, customizable (free tier available)</li>
<li style="margin:0.5em 0;"><strong>Google Maps API</strong> ‚Äî Powerful but costs money</li>
<li style="margin:0.5em 0;"><strong>OpenLayers</strong> ‚Äî Feature-rich, open-source</li>
</ul>

<p class="a">üåü ‚ú® üåà</p>

<p><a href="storage.html">Continue to Chapter 8: The Unicorn's Treasure Chest ‚Üí</a></p>

<div class="pf">
<h4>üåç Location Tips üåç</h4>
<div class="moneybags">
<p>Geolocation accuracy varies. GPS is most accurate, Wi-Fi positioning is okay, and IP-based location is often quite inaccurate. Always handle errors gracefully and respect user privacy!</p>
</div>
</div>

<p class="c">ü¶Ñ Enchanted with Unicorn Magic ü¶Ñ<br>
<small style="opacity:0.7;">Original wisdom by <a href="about.html">Mark Pilgrim</a> ‚Ä¢ Unicorn magic by Web Wizards</small></p>

<script src="j/jquery.js"></script>
<script src="j/dih5.js"></script>

</body>
</html>
